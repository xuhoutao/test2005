"use strict";var ehsySidebarfooter=document.getElementsByClassName("ehsy-sidebar-footer")[0],span1=ehsySidebarfooter.children[1],i1=ehsySidebarfooter.children[0];ehsySidebarfooter.onmouseenter=function(){i1.style.display="none",span1.style.display="block"},ehsySidebarfooter.onmouseleave=function(){i1.style.display="block",span1.style.display="none"},ehsySidebarfooter.onclick=function(){$("html").animate({scrollTop:0},200,"linear")},window.onscroll=function(){var e=getScroll().top;ehsySidebarfooter.style.display=e<=200?"none":"block"};for(var productcart=document.getElementsByClassName("product-cart"),imgb=document.getElementsByClassName("mod-recommend-img"),productname=document.getElementsByClassName("product-name"),productnum=document.getElementsByClassName("product-num"),ehsyyen=document.getElementsByClassName("ehsy-yen"),i=0;i<productcart.length;i++)productcart[i].onclick=function(){index=this.getAttribute("index");var e=document.createElement("div");e.setAttribute("class","product-list-body"),e.innerHTML='<ul class="cart-line clearfix"><li class="td_1"><input class="check-box-center" type="checkbox" name="keys[]" value="MAB675" ><a href="https://www.ehsy.com/product-MAB675"><img src="'+imgb[index].getAttribute("src")+'"></a></li><li class="td_2"><a href="https://www.ehsy.com/product-MAB675"><p class="product-title color-green">'+productname[index].innerHTML+'</p></a><p class="color-green">西域订货号：<span>'+productnum[index].children[0].innerHTML+'</span></p><p class="color-gray">最小订货量：<span>1把</span></p><p class="color-gray"><span>预计出货日：4个工作日</span></p><p class="color-gray">客户物料编码：<span><input class="upn-MAB675" style="border: 1px solid rgb(238,238,238)" type="text" name="user_product_no" value="" maxlength="40" disabled="true"></span><a class="update-upn" >修改</a></p></li><li class="td_3"><p>'+ehsyyen[index].innerHTML+'</p></li><li class="td_4"><div class="clearfix"><input class="a-sub disable-sub" type="button"  value="-" onclick="fn5(this)"><input type="text" id="shopcart_MAB675_quantity" name="qty[MAB675]" value="1" class="item-num-input"  orinum="1"><input class="a-add" type="button"  value="+" onclick="fn4(this)"></div></li><li class="td_5">'+ehsyyen[index].innerHTML+'</li><li class="td_6"><a class="product-favorite">加入收藏</a><a class="product-remove js-cart-product-remove" sku_code="MAB675">删除</a></li></ul>';var t=document.getElementsByClassName("sub-content")[0];t.parentNode.insertBefore(e,t)};var quan=document.getElementsByName("quanxuan")[0],inps=document.getElementsByName("keys[]"),layoutcart=document.getElementsByClassName("layout-cart")[0],inputs=document.getElementsByClassName("item-num-input"),foot=document.querySelector(".price-main");function total(){for(var e=0,t=0;t<inps.length;t++)if(inps[t].checked){var n=inps[t].parentNode.parentNode.children,a=n[n.length-2].innerHTML.substr(1);e+=parseFloat(a)}var s="¥"+(e=e.toFixed(1));foot.lastElementChild.innerHTML=s}function Number1(){for(var e=0,t=0;t<inps.length;t++)if(inps[t].checked){var n=inps[t].parentNode.parentNode.children[3].children[0].children[1].value;e+=parseInt(n)}foot.children[0].children[0].innerHTML=e}function fn4(e){var t=e.previousElementSibling.value;t++,e.previousElementSibling.value=t;var n=e.parentNode.parentNode.previousElementSibling.children[0].innerHTML.substr(1),a=(a=parseFloat(t)*parseFloat(n)).toFixed(1);su="¥"+a,console.log(su),e.parentNode.parentNode.nextElementSibling.innerHTML=su}function fn5(e){var t=e.nextElementSibling.value;t<=1?t=1:t--,e.nextElementSibling.value=t;var n=e.parentNode.parentNode.previousElementSibling.children[0].innerHTML.substr(1),a=(a=parseFloat(t)*parseFloat(n)).toFixed(1);su="¥"+a,e.parentNode.parentNode.nextElementSibling.innerHTML=su}total(),Number1(),layoutcart.onclick=function(e){var t=(e=e||event).target||e.srcElement;if("product-remove js-cart-product-remove"==t.className&&layoutcart.removeChild(t.parentNode.parentNode.parentNode),"btn-delete"==t.className)for(var n=inps.length-1;0<=n;n--){if(inps[n].checked)inps[n].parentNode.parentNode.parentNode.remove()}if("quanxuan"==t.getAttribute("name"))for(var n in inps)t.checked?inps[n].checked=!0:inps[n].checked=!1;if("keys[]"==t.getAttribute("name")){var a=0;for(n=0;n<inps.length;n++)inps[n].checked&&a++;a==inps.length?quan.checked=!0:quan.checked=!1}if("cart-to-checkout-btn js-checkout"==t.className){var s=foot.lastElementChild.innerHTML;if(parseInt(s)<="0")alert("你还没有购买商品，请重新选择");else if(confirm("你确定要购买这些商品吗？")){alert("已支付："+s);for(n=inps.length-1;0<=n;n--){if(inps[n].checked)inps[n].parentNode.parentNode.parentNode.remove()}}else alert("我现在后悔了，不买了")}total(),Number1()},window.onload=function(){$.get("../interface/showlist.php",function(e){var t=JSON.parse(e);if(console.log(t),0==t.code)alert("购物车空空如也");else{t=t.data;console.log(t);var n="",a=document.createElement("div");a.setAttribute("class","product-list-body"),t.forEach(function(e){n+='<ul class="cart-line clearfix"><li class="td_1"><input class="check-box-center" type="checkbox" name="keys[]" value="MAB675" ><a href="https://www.ehsy.com/product-MAB675"><img src="'+e.product_img+'"></a></li><li class="td_2"><a href="https://www.ehsy.com/product-MAB675"><p class="product-title color-green">'+e.product_name+'</p></a><p class="color-green">西域订货号：<span>'+e.product_id+'</span></p><p class="color-gray">最小订货量：<span>1把</span></p><p class="color-gray"><span>预计出货日：4个工作日</span></p><p class="color-gray">客户物料编码：<span><input class="upn-MAB675" style="border: 1px solid rgb(238,238,238)" type="text" name="user_product_no" value="" maxlength="40" disabled="true"></span><a class="update-upn" >修改</a></p></li><li class="td_3"><p>'+e.product_price+'</p></li><li class="td_4"><div class="clearfix"><input class="a-sub disable-sub" type="button"  value="-" onclick="fn5(this)"><input type="text" id="shopcart_MAB675_quantity" name="qty[MAB675]" value="'+e.product_num+'" class="item-num-input"  orinum="1"><input class="a-add" type="button"  value="+" onclick="fn4(this)"></div></li><li class="td_5">'+e.product_price+'</li><li class="td_6"><a class="product-favorite">加入收藏</a><a class="product-remove js-cart-product-remove" sku_code="MAB675">删除</a></li></ul>'}),a.innerHTML=n;var s=document.getElementsByClassName("sub-content")[0];s.parentNode.insertBefore(a,s)}})};var headerLeft=document.getElementsByClassName("header-left")[0];console.log(localStorage.getItem("un")),localStorage.getItem("un")&&(headerLeft.children[0].innerHTML="欢迎",headerLeft.children[1].remove(),headerLeft.children[1].innerHTML=localStorage.getItem("un"));